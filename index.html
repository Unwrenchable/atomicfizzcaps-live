<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>ATOMIC FIZZ • VAULT 77 • WASTELAND GPS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;background:#000;font-family:VT323,monospace;color:#00ff41}
  body{background:radial-gradient(circle at center,#002200,#000)}
  .pipboy{position:fixed;inset:0;padding:12px;background:#001100;box-shadow:0 0 160px #00ff41}
  .panel{position:absolute;inset:12px;background:#000;border-radius:14px;padding:14px;overflow:hidden;box-shadow:inset 0 0 80px #003300,0 0 80px rgba(0,255,65,0.18)}
  h1{font-size:2.6rem;letter-spacing:8px;background:linear-gradient(90deg,#00ff41,#66ff99);-webkit-background-clip:text;color:transparent;margin-bottom:6px}
  .sub{opacity:0.6;letter-spacing:6px;margin-bottom:12px}
  .header-row{display:flex;justify-content:space-between;gap:12px}
  .controls{display:flex;gap:8px;align-items:center}
  .btn,.wallet-btn{background:#001100;color:#00ff41;border:2px solid #00ff41;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:bold}
  .wallet-btn{background:#002200}
  #status{color:#ff66aa;font-size:0.95rem;min-width:220px;text-align:right}
  .statbar{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:12px 0}
  .stat{background:#000;border-radius:8px;padding:10px;border:2px solid rgba(0,255,65,0.06);text-align:center}
  .val{font-size:1.6rem;color:#ffff66}
  #mapWrap{height:56vh;border-radius:10px;overflow:hidden;border:2px solid rgba(0,255,65,0.06);box-shadow:inset 0 0 60px rgba(0,255,65,0.04);position:relative}
  #map{width:100%;height:100%}
  .tabs{display:flex;gap:8px;margin-top:12px}
  .tab{padding:8px 12px;border-radius:8px;background:rgba(0,0,0,0.25);border:1px solid rgba(0,255,65,0.06);cursor:pointer}
  .tab.active{background:#002200;border-color:#00ff41}
  .drawer{position:absolute;right:18px;top:86px;width:360px;max-height:56%;background:rgba(0,17,0,0.96);border:2px solid #00ff41;border-radius:10px;padding:12px;overflow:auto;z-index:1400;display:none}
  .drawer.open{display:block}
  .list-item{padding:8px 10px;border-bottom:1px dashed rgba(0,255,65,0.06);display:flex;justify-content:space-between;align-items:center}
  .muted{opacity:0.7}
  .muted-small{font-size:0.85rem;opacity:0.8}
  .gps-badge{position:absolute;left:18px;bottom:18px;background:rgba(0,0,0,0.8);border:2px solid #00ff41;padding:8px 12px;border-radius:10px;display:flex;gap:8px;align-items:center;z-index:1200}
  .acc-dot{width:12px;height:12px;border-radius:50%;background:#ff6666;box-shadow:0 0 8px rgba(255,102,102,0.2)}
  .acc-green{background:#66ff99;box-shadow:0 0 8px rgba(102,255,153,0.12)}
  .acc-amber{background:#ffcc66;box-shadow:0 0 8px rgba(255,204,102,0.12)}
  .mint-modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:#001100;border:2px solid #00ff41;padding:12px;border-radius:10px;z-index:2000;display:none}
  .mint-modal.open{display:block}
  @media (max-width:900px){.drawer{width:300px}}
  @media (max-width:640px){.drawer{width:260px;top:72px}.statbar{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
  <div class="pipboy">
    <div class="panel">
      <div class="header-row">
        <div><h1>ATOMIC FIZZ</h1><div class="sub">VAULT 77 • WASTELAND GPS</div></div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
          <div class="controls">
            <button class="btn" id="centerBtn">Center on Player</button>
            <button class="btn" id="recenterMojave">Recenter Mojave</button>
            <button class="wallet-btn" id="connectPhantom">Connect Phantom</button>
          </div>
          <div id="status">Status: ready</div>
        </div>
      </div>
      <div class="statbar">
        <div class="stat"><div class="val" id="lvl">1</div><div class="muted-small">LEVEL</div></div>
        <div class="stat"><div class="val" id="hp">100/100</div><div class="muted-small">HP</div></div>
        <div class="stat"><div class="val" id="caps">0</div><div class="muted-small">CAPS</div></div>
        <div class="stat"><div class="val" id="claimed">0</div><div class="muted-small">CLAIMED</div></div>
      </div>
      <div id="mapWrap"><div id="map"></div>
        <div class="gps-badge" id="gpsBadge"><div id="accDot" class="acc-dot"></div><div id="accText">GPS: —</div></div>
      </div>
      <div class="tabs">
        <div class="tab active" data-panel="map">MAP</div>
        <div class="tab" data-panel="stat">STAT</div>
        <div class="tab" data-panel="items">ITEMS</div>
        <div class="tab" data-panel="quests">QUESTS</div>
      </div>
      <div class="drawer" id="sidePanel">
        <button class="btn" id="panelClose" style="float:right">X</button>
        <h4 id="panelTitle">Panel</h4>
        <div id="panelBody"></div>
      </div>
      <div id="mintModal" class=" and mint-modal">
        <div id="mintTitle">Minting NFT</div>
        <div id="mintMsg" class="muted-small">Preparing...</div>
        <div id="mintProgress" style="height:8px;background:#002200;border-radius:6px;overflow:hidden;margin-top:8px">
          <i style="display:block;height:100%;background:linear-gradient(90deg,#00ff41,#66ff99);width:0%"></i>
        </div>
        <div style="margin-top:10px;text-align:right"><button class="btn" id="mintCloseBtn">Close</button></div>
      </div>
    </div>
  </div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>
<script>
/* ATOMIC FIZZ — MINIMAL COMPLETE STATIC — DEC 2025 */
/* No Next.js, no bloat, pure vanilla JS, your Google satellite map, hardcoded POIs, localStorage */
const API_BASE = ''; // static, no server
let map, playerMarker = null, wallet = null;
let player = { lvl:1, hp:100, caps:0, gear:[], claimed: new Set() };
let markers = {}, lastAccuracy = 999, playerLatLng = null;

const MAX_ACC = 20, CLAIM_RADIUS = 250;

// 8 POIs
const LOCATIONS = [
  { n: 'Hoover Dam', lat: 36.0159, lng: -114.7378, rarity: 'legendary' },
  { n: 'Vegas Strip', lat: 36.1097, lng: -115.1728, rarity: 'epic' },
  { n: 'Red Rock Canyon', lat: 36.1321, lng: -115.4282, rarity: 'rare' },
  { n: 'Helios One', lat: 36.2167, lng: -115.8667, rarity: 'common' },
  { n: 'Nipton', lat: 35.8667, lng: -114.3833, rarity: 'rare' },
  { n: 'Primm', lat: 35.8667, lng: -115.3833, rarity: 'common' },
  { n: 'Goodsprings', lat: 35.8333, lng: -115.4333, rarity: 'epic' },
  { n: 'Novac', lat: 36.55, lng: -114.6167, rarity: 'legendary' }
];

function pushGpsSample(lat, lng, acc) {
  lastAccuracy = acc || 999;
  document.getElementById('accText').textContent = `GPS: ${Math.round(lastAccuracy)}m`;
  const dot = document.getElementById('accDot');
  dot.className = lastAccuracy <= MAX_ACC ? 'acc-dot acc-green' : (lastAccuracy <= 40 ? 'acc-dot acc-amber' : 'acc-dot');
  playerLatLng = L.latLng(lat, lng);
  if (!playerMarker) playerMarker = L.circleMarker([lat,lng],{radius:8,color:'#00ff41',fillColor:'#00ff41'}).addTo(map).bindPopup('You');
  else playerMarker.setLatLng(playerLatLng);
}

function saveState() { localState = {player, claimed:Array.from(player.claimed), gear:player.gear}; localStorage.setItem('af', JSON.stringify(localState)); }
function loadState() { try { const s = JSON.parse(localStorage.getItem('af')||'{}'); if(s.player) Object.assign(player,s.player); if(s.claimed) player.claimed = new Set(s.claimed); if(s.gear) player.gear = s.gear; } catch(e){} }
loadState();

function updateUI() {
  document.getElementById('lvl').textContent = player.lvl;
  document.getElementById('hp').textContent = `${player.hp}/${100}`;
  document.getElementById('caps').textContent = player.caps;
  document.getElementById('claimed').textContent = player.claimed.size;
}

// Phantom
document.getElementById('connectPhantom').addEventListener('click', async () => {
  if (wallet) return;
  const p = window.solana;
  if (!p?.isPhantom) return alert('Phantom not found');
  try { await p.connect(); wallet = p; document.getElementById('connectPhantom').textContent = p.publicKey.toBase58().slice(0,8)+'...'; } catch(e) {}
});

// Tabs
document.querySelectorAll('.tab').forEach(t => t.addEventListener('click', () => {
  document.querySelectorAll('.tab').forEach(x => x.classList.remove('active')); t.classList.add('active');
  const p = t.dataset.panel;
  const drawer = document.getElementById('sidePanel');
  if (p === 'map') { drawer.classList.remove('open'); return; }
  drawer.classList.add('open'); document.getElementById('panelTitle').textContent = p.toUpperCase();
  let html = '';
  if (p === 'stat') html = `<div class="list-item"><strong>LEVEL</strong><div class="muted">${player.lvl}</div></div><div class="list-item"><strong>CAPS</strong><div class="muted">${player.caps}</div></div><div class="list-item"><strong>CLAIMED</strong><div class="muted">${player.claimed.size}/8</div></div><div class="list-item"><strong>GEAR</strong><div class="muted">${player.gear.length}</div></div>`;
  if (p === 'items') html = player.gear.length ? player.gear.map(g=>`<div class="list-item"><strong>${g.name}</strong><div class="muted">${g.rarity}</div></div>`).join('') : '<div class="list-item"><strong>No gear</strong></div>';
  if (p === 'quests') html = '<div class="list-item"><strong>Claim All POIs</strong><div class="muted">PROGRESS: '+player.claimed.size+'/8</div></div>';
  document.getElementById('panelBody').innerHTML = html;
}));
document.getElementById('panelClose').onclick = () => { document.getElementById('sidePanel').classList.remove('open'); document.querySelector('.tab[data-panel="map"]').classList.add('active'); };

// Map
function initMap() {
  map = L.map('map').setView([36.1146,-115.1728],12);
  L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{maxZoom:20}).addTo(map);
  LOCATIONS.forEach(loc => {
    const col = loc.rarity==='legendary'?'#ffff00':loc.rarity==='epic'?'#ff6200':loc.rarity==='rare'?'#00ffff':'#00ff41';
    const m = L.circleMarker([loc.lat, loc.lng], {radius:14,color:'#001100',weight:4,fillColor:col,fillOpacity:0.95})
      .bindPopup(`<b>${loc.n}</b><br>${loc.rarity.toUpperCase()}`)
      .on('click', () => attemptClaim(loc)).addTo(map);
    markers[loc.n] = m;
    if (player.claimed.has(loc.n)) m.setStyle({fillColor:'#001a00',fillOpacity:0.6});
  });
}

// Claim (local mock)
async function attemptClaim(loc) {
  if (!wallet) return alert('Connect Phantom');
  if (player.claimed.has(loc.n)) return;
  if (lastAccuracy > MAX_ACC) return alert('GPS too weak');
  if (!playerLatLng) return alert('No GPS');
  const dist = map.distance(playerLatLng, [loc.lat, loc.lng]);
  if (dist > CLAIM_RADIUS) return alert(`Too far (${Math.round(dist)}m)`);
  player.caps += 100;
  player.gear.push({name: loc.n + ' Cap', rarity: loc.rarity});
  player.claimed.add(loc.n);
  markers[loc.n].setStyle({fillColor:'#001a00',fillOpacity:0.6});
  saveState(); updateUI();
  document.getElementById('mintModal').classList.add('open');
  document.getElementById('mintMsg').textContent = 'LOOTED! +100 CAPS';
}
document.getElementById('mintCloseBtn').onclick = () => document.getElementById('mintModal').classList.remove('open');

// Buttons
document.getElementById('centerBtn').onclick = () => playerLatLng && map.flyTo(playerLatLng,16);
document.getElementById('recenterMojave').onclick = () => map.flyTo([36.17,-115.14],8);

// Start
window.addEventListener('load', () => {
  initMap();
  updateUI();
  navigator.geolocation?.watchPosition(p => pushGpsSample(p.coords.latitude, p.coords.longitude, p.coords.accuracy), null, {enableHighAccuracy:true});
  setInterval(saveState, 5000);
});
</script>
</body>
</html>
