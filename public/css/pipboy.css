/* === ULTIMATE RETRO PIP-BOY STYLE v1.1 === */

* { box-sizing:border-box; margin:0; padding:0; }

html, body {
  height: 100%;
  background: #000;
  font-family: 'VT323', monospace;
  color: #00ff41;
  overflow: hidden;
}

body {
  background: radial-gradient(circle at center, #002200, #000);
}

.pipboy {
  position: fixed;
  inset: 0;
  padding: 12px;
  background: #001100;
  box-shadow: 0 0 160px #00ff41;
}

.panel {
  position: absolute;
  inset: 12px;
  background: #000;
  border-radius: 14px;
  padding: 14px;
  overflow: hidden;
  box-shadow: inset 0 0 80px #003300, 0 0 80px rgba(0,255,65,0.18);
}

h1 {
  font-size: 2.6rem;
  letter-spacing: 8px;
  background: linear-gradient(90deg, #00ff41, #66ff99);
  -webkit-background-clip: text;
  color: transparent;
  margin-bottom: 6px;
}

.sub {
  opacity: 0.6;
  letter-spacing: 6px;
  margin-bottom: 12px;
}

.header-row {
  display: flex;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
}

.controls {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: center;
}

.btn, .wallet-btn {
  background: #001100;
  color: #00ff41;
  border: 2px solid #00ff41;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: background .3s;
}

.btn:hover, .wallet-btn:hover {
  background: #002200;
}

.wallet-btn {
  background: #002200;
}

#status {
  color: #ff66aa;
  font-size: 0.95rem;
  text-align: center;
  margin-top: 8px;
  transition: color .5s;
}

.status-good { color: #66ff99; }
.status-bad { color: #ff6666; }

.pip-status {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 10px 0;
  padding: 6px;
  background: #001100;
  border: 2px solid #00ff41;
  border-radius: 8px;
}

.pip-lvl, .pip-caps {
  font-size: 1.1rem;
  opacity: 0.9;
}

.pip-hp-container {
  position: relative;
  flex: 1;
  height: 28px;
  background: #000;
  border: 2px solid #00ff41;
  border-radius: 8px;
  overflow: hidden;
  margin: 0 12px;
  box-shadow: inset 0 0 15px #003300;
}

.pip-hp-fill {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  background: #00ff41;
  transition: width .6s ease;
}

.pip-rad-fill {
  position: absolute;
  right: 0;
  top: 0;
  height: 100%;
  width: 0%;
  background: #ff0033;
  opacity: .7;
  transition: width .6s ease;
}

.pip-hp-text {
  position: absolute;
  width: 100%;
  text-align: center;
  line-height: 28px;
  font-size: 1rem;
  color: #fff;
  text-shadow: 0 0 8px #000;
  z-index: 1;
}

.pip-claimed {
  text-align: center;
  font-size: .95rem;
  margin-top: 4px;
  opacity: .7;
}

/* Enhanced Map Wrapper â€“ Ultimate Retro Screen */
#mapWrap {
  position: relative;
  height: 42vh;
  overflow: hidden;
  border-radius: 16px;
  box-shadow:
    inset 0 0 80px #003300,
    0 0 60px rgba(0, 255, 65, 0.4);
  background: #000;
  animation:
    gentle-glow 8s ease-in-out infinite alternate,
    rare-flicker 15s infinite;
}

#map {
  width: 100%;
  height: 100%;
  background: #001100 !important;
}

/* Monochrome Green Map Tiles */
.leaflet-tile-pane {
  filter:
    brightness(1.4)
    contrast(2)
    sepia(0.3)
    hue-rotate(90deg)
    saturate(3)
    grayscale(0.2);
  opacity: 0.96;
}

/* Dark Radial Tint Overlay */
#map::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at center, transparent 40%, rgba(0, 30, 0, 0.6) 100%);
  pointer-events: none;
  z-index: 1000;
  border-radius: 16px;
}

/* CRT Scanlines */
#map::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.15) 2px,
    rgba(0, 0, 0, 0.15) 4px
  );
  pointer-events: none;
  z-index: 1001;
  opacity: 0.5;
  animation: slow-scan 12s linear infinite;
  border-radius: 16px;
}

@keyframes slow-scan {
  0% { background-position: 0 0; }
  100% { background-position: 0 4px; }
}

/* Subtle Terminal Grid */
#mapWrap::after {
  content: '';
  position: absolute;
  inset: 0;
  background:
    linear-gradient(90deg, rgba(0, 255, 65, 0.06) 1px, transparent 1px),
    linear-gradient(0deg, rgba(0, 255, 65, 0.06) 1px, transparent 1px);
  background-size: 50px 50px;
  pointer-events: none;
  z-index: 1002;
  opacity: 0.35;
  border-radius: 16px;
}

/* Static Noise Overlay */
.static-noise {
  position: absolute;
  inset: 0;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" stitchTiles="stitch"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"/></filter><rect width="100" height="100" filter="url(#noise)" opacity="0.15"/></svg>') repeat;
  pointer-events: none;
  z-index: 1003;
  opacity: 0.3;
  animation: noise-flicker 0.1s steps(4) infinite;
  border-radius: 16px;
}

@keyframes noise-flicker {
  0% { opacity: 0.25; }
  100% { opacity: 0.35; }
}

/* Barrel Distortion + Rounded Screen Mask */
.leaflet-container {
  border-radius: 16px;
  overflow: hidden;
  mask-image: radial-gradient(circle at center, black 85%, transparent 100%);
  -webkit-mask-image: radial-gradient(circle at center, black 85%, transparent 100%);
}

/* Glow Pulse Animation */
@keyframes gentle-glow {
  0% {
    box-shadow:
      inset 0 0 80px #003300,
      0 0 50px rgba(0, 255, 65, 0.3);
  }
  100% {
    box-shadow:
      inset 0 0 100px #004400,
      0 0 80px rgba(0, 255, 65, 0.5);
  }
}

@keyframes rare-flicker {
  0%, 95%, 100% { opacity: 1; }
  96% { opacity: 0.97; }
  97% { opacity: 0.99; }
}

/* Shop Buy Buttons */
.shop-buy-btn {
  background: #001100;
  color: #00ff41;
  border: 1px solid #00ff41;
  padding: 6px 12px;
  font-size: 0.9em;
  margin-top: 8px;
  cursor: pointer;
}

.shop-buy-btn:hover:not(:disabled) {
  background: #003300;
}

.shop-buy-btn:disabled {
  color: #003300;
  border-color: #003300;
  opacity: 0.5;
  cursor: not-allowed;
}

/* Rest of Original Styles (Tabs, Terminal, etc.) */
.tabs {
  display: flex;
  gap: 8px;
  margin-top: 12px;
  flex-wrap: wrap;
  justify-content: center;
}

.tab {
  padding: 8px 12px;
  border-radius: 8px;
  background: rgba(0,0,0,.25);
  border: 1px solid rgba(0,255,65,.06);
  cursor: pointer;
  font-size: .95rem;
  transition: background .3s;
}

.tab.active, .tab:hover {
  background: #002200;
  border-color: #00ff41;
}

.terminal {
  position: absolute;
  right: 0;
  left: 0;
  bottom: 0;
  width: 100%;
  max-height: 70%;
  background: rgba(0,17,0,.96);
  border: 2px solid #00ff41;
  border-radius: 14px 14px 0 0;
  padding: 12px;
  overflow: auto;
  z-index: 9999;
  display: none;
  transition: transform .4s ease;
}

.terminal.open {
  display: block;
  transform: translateY(0);
}

.list-item {
  padding: 8px 10px;
  border-bottom: 1px dashed rgba(0,255,65,.06);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.muted { opacity: .7; }
.muted-small { font-size: .85rem; opacity: .8; }

.gps-badge {
  position: absolute;
  left: 18px;
  bottom: 18px;
  background: rgba(0,0,0,.8);
  border: 2px solid #00ff41;
  padding: 8px 12px;
  border-radius: 10px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 1200;
  font-size: .9rem;
}

.acc-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #ff6666;
  box-shadow: 0 0 8px rgba(255,102,102,.2);
  animation: pulseRed 1.5s infinite;
}

.acc-green { background: #66ff99; box-shadow: 0 0 8px rgba(102,255,153,.6); animation: none; }
.acc-amber { background: #ffcc66; box-shadow: 0 0 8px rgba(255,204,102,.6); animation: none; }

@keyframes pulseRed {
  0%,100% { box-shadow: 0 0 8px rgba(255,102,102,.2); }
  50% { box-shadow: 0 0 20px rgba(255,102,102,.8); }
}

.mint-modal {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  background: #001100;
  border: 2px solid #00ff41;
  padding: 20px;
  border-radius: 10px;
  z-index: 2000;
  display: none;
  width: 90%;
  max-width: 420px;
  box-shadow: 0 0 40px #00ff41;
}

.mint-modal.open { display: block; }

#requestGpsBtn {
  position: absolute;
  left: 18px;
  bottom: 80px;
  z-index: 1200;
  padding: 8px 12px;
  font-size: .9rem;
  background: #002200;
  border: 2px solid #ff6666;
  border-radius: 8px;
  cursor: pointer;
  transition: background .3s;
}

#requestGpsBtn:hover { background: #330000; }

/* Leaflet & Scrollbar Overrides */
.leaflet-control-container .leaflet-control-zoom,
.leaflet-control-attribution { display: none !important; }

::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: #001100; border-radius: 10px; }
::-webkit-scrollbar-thumb { background: #00ff41; border: 2px solid #003300; border-radius: 10px; box-shadow: 0 0 8px rgba(0,255,65,0.6); }
::-webkit-scrollbar-thumb:hover { background: #66ff99; box-shadow: 0 0 12px rgba(0,255,65,0.8); }
::-webkit-scrollbar-corner { background: #001100; }
*{ scrollbar-width: thin; scrollbar-color: #00ff41 #001100; }

/* Mobile Tweaks */
@media (max-width: 768px) {
  .pipboy { padding: 8px; }
  .panel { padding: 10px; inset: 8px; }
  h1 { font-size: 2rem; letter-spacing: 6px; }
  .controls { gap: 6px; }
  .btn, .wallet-btn { padding: 10px 12px; font-size: 1rem; }
  .pip-status { padding: 6px; }
  .pip-lvl, .pip-caps { font-size: 1rem; }
  .pip-hp-container { height: 26px; margin: 0 8px; }
  .pip-hp-text { line-height: 26px; font-size: .95rem; }
  #mapWrap { height: 38vh; min-height: 280px; }
  #mapWrap::after { background-size: 40px 40px; }
  .leaflet-tile-pane { filter: brightness(1.5) contrast(2.2) sepia(0.3) hue-rotate(90deg) saturate(3.2); }
  @keyframes slow-scan { 100% { background-position: 0 3px; } }
  .tabs { gap: 6px; }
  .tab { padding: 8px 12px; font-size: 1rem; }
  #requestGpsBtn { bottom: 70px; font-size: .9rem; padding: 10px 14px; }
}
